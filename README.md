# TDD

- > ## Nodejs 기초

  - 크롬에서 사용하는 V8 엔진을 사용한다 그렇기에 자바스크립트 코드를 인터넷 밖에서 사용 할 수 있게 한다.
  - 이벤트 기반의 비동기 I/O 프레임워크다
    - 요약 : 클라이언트가 보낸 모든 요청을 이벤트로 처리 & 무거운 일들은 워커스레드에 전달해서 비동기로 처리하는 부분존재.
    - 클라이언트쪽에서 어플리케이션으로 요청을 보내면 nodejs는 요청을 event로 만들어서 queue(대기열)에다가 쌓음, 그리고 이벤트 루프라는 것은 큐에있는 이벤트 하나하나를 뽑아내서 실행, 이벤트루프는 싱글 스레드인데, 이 이벤트루프가 일을 처리하고 client에게 응답. (nodejs는 싱글스레드다 라는 얘기가 이 이벤트 루프에서 나옴.)
    - 비동기 I/O 라는건 이벤트루프가 외부 네트워크 통신같은 큰 일을 직접 실행하지 않고 다른 스레드에게 그 일을 위임, 무거운 일을 실행하는 워커들은 이벤트 루프에서 받은 일을 실행하고 완료되면 그 결과를 이벤트 형태로 다시 큐에 전달, 이벤트 루프는 큐에 있는 이벤트들을 실행하다가 워커 스레드가 보내준 이벤트를 큐에서 뽑으면 실행이 완료된 후 결과를 클라이언트에게 보내줌.
  - 모듈 시스템이 있다
    - 기본모듈, 써드파티모듈, 사용자 정의 모듈
    - commonJS 는 파일형태로 모듈을 관리할 수 있게 함.
  - 비동기 세계
    - 노드는 기본적으로 비동기로 동작함.
    - Synchronous 에서는 System Call이 끝날때까지 기다리고 결과물을 가져온다.
    - Asynchronous 에서는 System Call이 완료되지 않아도 나중에 완료가 되면 그때 결과물을 가져온다.

- > ## Expressjs 기초

  - 어플리케이션
    - const app = express()
    - 익스프레스 인스턴스를 의미
    - 서버에 필요한 기능인 미들웨어를 추가할 수 있다.
    - 라우팅 설정을 할수있다.
    - 서버를 요청 대기상태로 둔다.
  - 미들웨어
    - 미들웨어는 함수들의 연속.
    - use로 추가 가능.
    - 일반 미들웨어(req, res, next) / 에러 미들웨어(err, req, res, next)
    - 에러미들웨어 : 전달받은 에러를 처리 하거나 next(err) 로 다음 미들웨어로 err를 넘길 수 있다.
  - 요청객체, 응답객체
    - 요청객체 : http 모듈의 request객체를 래핑한 것
    - req.params(), req.query(), req.body() 를 주로 사용한다.
    - 응답객체 : http 모듈의 request객체를 래핑한 것
    - res.send(), res.status(), res.json() 을 주로 사용한다.

- > ## REST API

  - 요청 형식
    - **모든 자원은 명사로 식별한다**.
    - GET(조회), POST(생성), PUT(갱신), DELETE(삭제)
  - 응답 형식

    - 상태코드 200: 성공 GET, PUT
    - 상태코드 201: 작성됨 POST
    - 상태코드 204: 성공,내용없음 DELETE
    - 상태코드 400: 잘못된요청
    - 상태코드 401: 권한없음
    - 상태코드 404: 찾을 수 없음
    - 상태코드 409: 생성시 충돌
    - 상태코드 500대: 서버에러

  - > ## TDD

    - 바로 소스코드를 작성하지 않고 테스트코드를 우선 작성한다.
    - 라이브러리
      - mocha : 테스트 코드를 돌려주는 테스트 러너, 테스트수트: 테스트환경으로 모카에서는 describe함수로 구현, 테스트케이스: 실제 테스트이고 it()함수로 구현
      - should : 검증에 사용
      - supertest : 익스프레스 통합 테스트용 라이브러리
      - 내부적으로 익스프레스 서버를 구동시켜 실제 요청을 보낸 뒤 결과를 검증한다.
    - 단위테스트 : 함수의 기능테스트 / 통합 테스트: API의 기능 테스트 /
    - somethin.spec.js 에서 spec이 들어가있으면 보통 테스트 코드를 작성하는 곳.
    - assert : 검증모듈 but 사용하지말고 should를 사용해서 검증한다.

  - > ## TDD 로 하는 서버 개발

    - ### 1
    - 성공시 : 유저 객체를 담은 배열로 응답, 최대 limit 갯수만큼 응답
    - 실패시 : limit이 숫자형이 아니면 400을 응답, offset이 숫자형이 아니면 400 응답.

    - before : it 실행전에 실행됨.
